/*
Script generated by Aqua Data Studio 8.0.2 on Jan-15-2010 01:50:27 PM
Database: TrackerPal
Schema: <All Schemas>
Objects: PROCEDURE
*/
-- =============================================
-- Author:		Rick Bertelsen
-- Create date: Oct. 29, 2008
-- Description:	Daylight Savings Time adjustment of EArrest Rules
-- =============================================
CREATE PROCEDURE [ERuleGetByOffenderIDDST3] 
	-- Add the parameters for the stored procedure here
	@OffenderID int
AS
SET NOCOUNT ON

	 SELECT er.ID as 'ERuleID',er.[Name],    
            r.UploadStatusID,    
            g.GeoRuleStatusName as 'StatusName',    
     b.id as 'BeaconID', b.BeaconName, r.updateinprogress as 'UpdateInProgress',  
 case when r.FileID is null then 0 else r.FileID end as 'FileID'      ,bo.OffenderID
 FROM dbo.ERule er    
	
 inner join [Rule] r ON r.ID=er.RuleID    
    inner join GeoRuleStatus g ON g.GeoRuleStatusID=r.UploadStatusID  and r.UploadStatusID in (3, 4)  
 inner join Beacon b ON b.ID=er.BeaconID    
 inner join BeaconOffender bo ON bo.BeaconID=b.ID   
 inner join Etracker et on er.AssignedEtrackerID = et.EtrackerID     
    inner join Tracker t on t.TrackerUniqueID = et.TrackerID     
 
    WHERE   bo.OffenderID=@OffenderID ORDER BY b.BeaconName DESC

GO
GRANT EXECUTE ON [ERuleGetByOffenderIDDST3] TO [db_dml]
GO
