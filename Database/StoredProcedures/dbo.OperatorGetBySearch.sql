/*
Script generated by Aqua Data Studio 8.0.2 on Jan-15-2010 01:50:27 PM
Database: TrackerPal
Schema: <All Schemas>
Objects: PROCEDURE
*/
CREATE PROCEDURE [OperatorGetBySearch]

	@FirstName	NVARCHAR(50),
	@LastName	NVARCHAR(50),
	@RoleID		INT

AS


	SELECT	o.OperatorID, o.FirstName, o.LastName, r.[Role]
				FROM	Operator o
				LEFT JOIN [User] u ON o.UserID = u.UserID
				LEFT JOIN User_Role ur ON u.UserID = ur.UserID
				LEFT JOIN [Role] r ON ur.RoleID = r.RoleID
				WHERE	
				(
					(LEN(@FirstName) <= 0 )
					OR
					(o.FirstName LIKE '%' + @FirstName + '%')
				)	
				AND
				(
					(LEN(@LastName) <= 0)
					OR
					(o.LastName Like '%' + @LastName + '%')
				)	
				AND
				(
					(@RoleID =0)
					OR
					(ur.RoleID = @RoleID)
				)	
				and
				o.Deleted = 0
				ORDER BY r.[Role], o.LastName, o.FirstName
GO
GRANT VIEW DEFINITION ON [OperatorGetBySearch] TO [db_object_def_viewers]
GO
GRANT EXECUTE ON [OperatorGetBySearch] TO [db_dml]
GO
