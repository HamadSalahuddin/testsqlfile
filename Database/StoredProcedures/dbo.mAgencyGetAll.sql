/*
Script generated by Aqua Data Studio 8.0.2 on Jan-15-2010 01:50:27 PM
Database: TrackerPal
Schema: <All Schemas>
Objects: PROCEDURE
*/
CREATE PROCEDURE [mAgencyGetAll]
	@AgencyID	INT =-1,
	@RoleID		INT =-1,
	@UserID INT =-1

AS

IF @RoleID = 2 or @RoleID = 15 
	BEGIN
		SELECT	AgencyID, Agency 
		FROM	Agency (NOLOCK)
	 WHERE	deleted = 0 and
		AgencyID = @AgencyID
		ORDER BY Agency
	END
ELSE IF @RoleID = 8 or @RoleID = 4
	BEGIN
		SELECT	AgencyID, Agency 
		FROM	Agency (NOLOCK)
	 WHERE	deleted = 0
		ORDER BY Agency
	END

ELSE IF @RoleID = 6 OR @RoleID = 20
	BEGIN
	SELECT	AgencyID, Agency 
		FROM	Agency a(NOLOCK)
		inner join distributoremployee de on a.DistributorID=de.DistributorID and de.UserID=@UserID
		 WHERE	a.deleted = 0
		ORDER BY Agency
	END

ELSE IF @RoleID = 19
	BEGIN
	SELECT	AgencyID, Agency 
		FROM	Agency a(NOLOCK)
		inner join distributor d on d.DistributorID= a.DistributorID and d.TamID=@UserID 
WHERE	a.deleted = 0
		ORDER BY Agency
	END

ELSE
	BEGIN
	SELECT	AgencyID, Agency 
		FROM	Agency a(NOLOCK)
WHERE	a.deleted = 0
		ORDER BY Agency
	END
GO
GRANT EXECUTE ON [mAgencyGetAll] TO [db_dml]
GO
