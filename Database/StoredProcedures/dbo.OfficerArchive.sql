/*
Script generated by Aqua Data Studio 8.0.2 on Jan-15-2010 01:50:27 PM
Database: TrackerPal
Schema: <All Schemas>
Objects: PROCEDURE
*/
CREATE PROCEDURE [OfficerArchive]
	@OfficerID		INT,
	@ModifiedByID	INT
AS
BEGIN

	UPDATE Officer
	SET	Deleted = 1,
		ModifiedDate = GETDATE(),
		ModifiedByID = @ModifiedByID
	WHERE OfficerID = @OfficerID

	UPDATE [User]
	SET Deleted = 1,
		ModifiedDate = GETDATE(),
		ModifiedByID = @ModifiedByID
	WHERE UserID = (SELECT o.UserID AS 'OfficerUserID' FROM Officer o WHERE OfficerID = @OfficerID)
			

END


GO
GRANT VIEW DEFINITION ON [OfficerArchive] TO [db_object_def_viewers]
GO
GRANT EXECUTE ON [OfficerArchive] TO [db_dml]
GO
