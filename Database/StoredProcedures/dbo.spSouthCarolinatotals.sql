/*
Script generated by Aqua Data Studio 8.0.2 on Jan-15-2010 01:50:28 PM
Database: TrackerPal
Schema: <All Schemas>
Objects: PROCEDURE
*/
--DECLARE 
--@StartDate DateTime,
--@EndDate DateTime
----@Eventid int
--
--SET @StartDate = '2008-04-01'
--SET @EndDate = '2008-05-01'
CREATE PROCEDURE [spSouthCarolinatotals]
@StartDate DateTime,
@EndDate DAtetime
AS
Select 
ag.Agency,
et.AbbrevEventType,
COUNT(et.AbbrevEventType) AS 'Total'

FROM 
Alarm a 
INNER JOIN Eventtype et ON et.eventtypeid = a.eventtypeid
INNER JOIN Offender o on a.Offenderid = o.Offenderid
INNER JOIN Agency ag ON ag.Agencyid = o.agencyid

WHERe a.EventDisplaytime >= @StartDate AND a.EventDisplaytime < @EndDate
AND ag.distributorid = 8
GROUP BY ag.agency, et.AbbrevEventType
ORDER BY ag.agency, et.AbbrevEventType
GO
GRANT EXECUTE ON [spSouthCarolinatotals] TO [db_dml]
GO
