/*
Script generated by Aqua Data Studio 8.0.2 on Jan-15-2010 01:50:27 PM
Database: TrackerPal
Schema: <All Schemas>
Objects: PROCEDURE
*/
CREATE PROCEDURE [OfficerUpdatePriorityContact]
@OfficerID int,
@ContactType1 int = null,
@ContactType2 int = null,
@ContactType3 int = null,
@ContactType4 int = null,
@Name1 nvarchar(50) = null,
@Name2 nvarchar(50) = null,
@Name3 nvarchar(50) = null,
@Name4 nvarchar(50) = null,
@Phone1 nvarchar(50) = null,
@Phone2 nvarchar(50) = null,
@Phone3 nvarchar(50) = null,
@Phone4 nvarchar(50) = null,
@Email1 nvarchar(50) = null,
@Email2 nvarchar(50) = null,
@Email3 nvarchar(50) = null,
@Email4 nvarchar(50) = null
AS
BEGIN
	SET NOCOUNT ON;
IF (SELECT Count(*) FROM PriorityContact WHERE OfficerID = @OfficerID) > 0
BEGIN
	UPDATE PriorityContact
	SET
	PriorityContactType1 = @ContactType1,
	PriorityContactType2 = @ContactType2,
	PriorityContactType3 = @ContactType3,
	PriorityContactType4 = @ContactType4,
	PriorityContactName1 = @Name1,
	PriorityContactName2 = @Name2,
	PriorityContactName3 = @Name3,
	PriorityContactName4 = @Name4,
	PriorityContactPhone1 = @Phone1,
	PriorityContactPhone2 = @Phone2,
	PriorityContactPhone3 = @Phone3,
	PriorityContactPhone4 = @Phone4,
	PriorityContactEmail1 = @Email1,
	PriorityContactEmail2 = @Email2,
	PriorityContactEmail3 = @Email3,
	PriorityContactEmail4 = @Email4

	WHERE OfficerID = @OfficerID
END
ELSE
BEGIN
INSERT INTO PriorityContact (OfficerID,PriorityContactType1,PriorityContactType2,
	PriorityContactType3,PriorityContactType4,PriorityContactName1,PriorityContactName2,
	PriorityContactName3,PriorityContactName4,PriorityContactPhone1,PriorityContactPhone2,
	PriorityContactPhone3,PriorityContactPhone4,PriorityContactEmail1,PriorityContactEmail2,
	PriorityContactEmail3,PriorityContactEmail4)
VALUES(@OfficerID,@ContactType1,@ContactType2, @ContactType3, @ContactType4, 
@Name1, @Name2, @Name3, @Name4, @Phone1, @Phone2, @Phone3, @Phone4, 
@Email1, @Email2, @Email3, @Email4)
END

END
GO
GRANT EXECUTE ON [OfficerUpdatePriorityContact] TO [db_dml]
GO
GRANT VIEW DEFINITION ON [OfficerUpdatePriorityContact] TO [db_object_def_viewers]
GO
