/*
Script generated by Aqua Data Studio 8.0.2 on Jan-15-2010 01:50:28 PM
Database: TrackerPal
Schema: <All Schemas>
Objects: PROCEDURE
*/
CREATE PROCEDURE [UserPreferencesUpdate]
@UserID int,
@GridPage int = null,
@GridOrderByColumn nvarchar(50) = null,
@GridOrderDirection nvarchar(50) = null,
@GridItemsPerPage int = null
AS
BEGIN
        SET NOCOUNT ON;
        IF (SELECT Count(*) FROM dbo.UserPreferences WHERE UserID = @UserID) > 0
                BEGIN
                UPDATE dbo.UserPreferences
                SET
                GridPage = @GridPage,
                GridOrderByColumn = @GridOrderByColumn,
                GridOrderDirection = @GridOrderDirection,
                GridItemsPerPage = @GridItemsPerPage
                WHERE UserID = @UserID
        END
        ELSE
                BEGIN
                INSERT INTO dbo.UserPreferences (UserID, GridPage, GridOrderByColumn, GridOrderDirection, GridItemsPerPage)
                VALUES(@UserID, @GridPage, @GridOrderByColumn, @GridOrderDirection, @GridItemsPerPage)
        END

END

GO
GRANT EXECUTE ON [UserPreferencesUpdate] TO [db_dml]
GO
GRANT VIEW DEFINITION ON [UserPreferencesUpdate] TO [db_object_def_viewers]
GO
