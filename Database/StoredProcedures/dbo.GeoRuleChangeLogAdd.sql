/*
Script generated by Aqua Data Studio 8.0.2 on Jan-15-2010 01:50:27 PM
Database: TrackerPal
Schema: <All Schemas>
Objects: PROCEDURE
*/
CREATE PROCEDURE [GeoRuleChangeLogAdd]

	@GeoRuleID					INT,
	@ModifiedByID				INT,
	@ModifiedDate				Datetime,
	@OriginalValues				nvarchar(3000),
	@NewValues				    nvarchar(3000)

AS

	INSERT INTO GeoRuleChangeLog
	([GeoRuleID], [ModifiedByID], [ModifiedDate], [OriginalValues], [NewValues], [TrackerID], [OffenderID])
		SELECT
			@GeoRuleID,
			@ModifiedByID,
			@ModifiedDate,
			@OriginalValues,
			@NewValues,
			o.TrackerID,
			o.OffenderID
		FROM GeoRule g
			INNER JOIN GeoRule_Offender geo_o ON g.GeoRuleID = geo_o.GeoRuleID
			INNER JOIN Offender o ON geo_o.OffenderID = o.OffenderID
		WHERE g.GeoRuleID =  @GeoRuleID
		
GO
GRANT VIEW DEFINITION ON [GeoRuleChangeLogAdd] TO [db_object_def_viewers]
GO
GRANT EXECUTE ON [GeoRuleChangeLogAdd] TO [db_dml]
GO
