/*
Script generated by Aqua Data Studio 8.0.2 on Jan-15-2010 01:50:27 PM
Database: TrackerPal
Schema: <All Schemas>
Objects: PROCEDURE
*/
CREATE PROCEDURE [DistributorEmployeeGetAllByDistributorID]
	@DistributorID	INT
AS
BEGIN
	SET NOCOUNT ON;
	if(@DistributorID = 0)
	begin
		SELECT	de.DistributorEmployeeID, 
				de.FirstName, 
				de.LastName, 
				d.DistributorName,
				r.[Role],
				de.DistributorID

		FROM DistributorEmployee de
		LEFT JOIN User_Role ur ON de.UserID = ur.UserID
		LEFT JOIN Role r ON ur.RoleID = r.RoleID
		INNER JOIN Distributor d ON de.DistributorID = d.DistributorID
		WHERE de.deleted = 0
		ORDER BY d.DistributorName
	end
	else
	begin
		SELECT	de.DistributorEmployeeID,
				de.FirstName,
				de.LastName,
				d.DistributorName,
				r.[Role],
				de.DistributorID
		FROM DistributorEmployee de
		LEFT JOIN User_Role ur ON de.UserID = ur.UserID
		LEFT JOIN Role r ON ur.RoleID = r.RoleID
		INNER JOIN Distributor d ON de.DistributorID = d.DistributorID
		WHERE de.deleted = 0 AND de.DistributorID = @DistributorID
		ORDER BY d.DistributorName
	end
END


GO
GRANT VIEW DEFINITION ON [DistributorEmployeeGetAllByDistributorID] TO [db_object_def_viewers]
GO
GRANT EXECUTE ON [DistributorEmployeeGetAllByDistributorID] TO [db_dml]
GO
